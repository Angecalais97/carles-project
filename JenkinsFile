pipeline {
  agent any
  tools {
    maven 'maven'
  }
  stages {
    stage ('SCM') {
      steps {
        git branch: 'main', url: 'https://github.com/Angecalais97/carles-project/'
      }
    }
    stage ('Build, Compile, Test, Package') {
      steps {
        sh '''
        mvn --version
        sudo mkdir -p /var/jenkins_home/maven_repository
        sudo chown -R automation:automation /var/jenkins_home/maven_repository
        sudo chmod -R 755 /var/jenkins_home/maven_repository
        ls -ld /var/jenkins_home/maven_repository

        mvn clean package -Dmaven.repo.local=/var/jenkins_home/maven_repository
        '''
      }
    }
  }
}
